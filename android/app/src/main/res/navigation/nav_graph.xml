<?xml version="1.0" encoding="utf-8"?>
<navigation xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/nav_graph"
    app:startDestination="@id/welcomeFragment">

    <!-- Auth Flow -->
    <fragment
        android:id="@+id/welcomeFragment"
        android:name="com.aerosense.app.ui.screens.auth.WelcomeFragment"
        android:label="Welcome"
        tools:layout="@layout/fragment_welcome">
        <action
            android:id="@+id/action_welcome_to_signUp"
            app:destination="@id/signUpFragment" />
        <action
            android:id="@+id/action_welcome_to_signIn"
            app:destination="@id/signInFragment" />
    </fragment>

    <fragment
        android:id="@+id/signUpFragment"
        android:name="com.aerosense.app.ui.screens.auth.SignUpFragment"
        android:label="Sign Up"
        tools:layout="@layout/fragment_sign_up">
        <action
            android:id="@+id/action_signUp_to_notificationPermission"
            app:destination="@id/notificationPermissionFragment" />
        <action
            android:id="@+id/action_signUp_to_addFirstFlight"
            app:destination="@id/addFirstFlightFragment" />
    </fragment>

    <fragment
        android:id="@+id/signInFragment"
        android:name="com.aerosense.app.ui.screens.auth.SignInFragment"
        android:label="Sign In"
        tools:layout="@layout/fragment_sign_in">
        <action
            android:id="@+id/action_signIn_to_main"
            app:destination="@id/flightsFragment"
            app:popUpTo="@id/welcomeFragment"
            app:popUpToInclusive="true" />
    </fragment>

    <fragment
        android:id="@+id/notificationPermissionFragment"
        android:name="com.aerosense.app.ui.screens.auth.NotificationPermissionFragment"
        android:label="Notification Permission"
        tools:layout="@layout/fragment_notification_permission">
        <action
            android:id="@+id/action_notificationPermission_to_addFirstFlight"
            app:destination="@id/addFirstFlightFragment" />
    </fragment>

    <fragment
        android:id="@+id/addFirstFlightFragment"
        android:name="com.aerosense.app.ui.screens.auth.AddFirstFlightFragment"
        android:label="Add First Flight"
        tools:layout="@layout/fragment_add_first_flight">
        <action
            android:id="@+id/action_addFirstFlight_to_main"
            app:destination="@id/flightsFragment"
            app:popUpTo="@id/welcomeFragment"
            app:popUpToInclusive="true" />
    </fragment>

    <!-- Main App Flow (Bottom Nav Tabs) -->
    <fragment
        android:id="@+id/flightsFragment"
        android:name="com.aerosense.app.ui.screens.flights.FlightsFragment"
        android:label="Flights"
        tools:layout="@layout/fragment_flights">
        <action
            android:id="@+id/action_flights_to_flightDetail"
            app:destination="@id/flightDetailFragment" />
        <action
            android:id="@+id/action_flights_to_addFlight"
            app:destination="@id/addFlightBottomSheet" />
    </fragment>

    <fragment
        android:id="@+id/notificationsFragment"
        android:name="com.aerosense.app.ui.screens.notifications.NotificationsFragment"
        android:label="Notifications"
        tools:layout="@layout/fragment_notifications">
        <action
            android:id="@+id/action_notifications_to_settings"
            app:destination="@id/notificationSettingsFragment" />
    </fragment>

    <fragment
        android:id="@+id/settingsFragment"
        android:name="com.aerosense.app.ui.screens.settings.SettingsFragment"
        android:label="Settings"
        tools:layout="@layout/fragment_settings">
        <action
            android:id="@+id/action_settings_to_notificationSettings"
            app:destination="@id/notificationSettingsFragment" />
        <action
            android:id="@+id/action_settings_to_accountSettings"
            app:destination="@id/accountSettingsFragment" />
    </fragment>

    <!-- Flight Detail Flow -->
    <fragment
        android:id="@+id/flightDetailFragment"
        android:name="com.aerosense.app.ui.screens.flights.FlightDetailFragment"
        android:label="Flight Detail"
        tools:layout="@layout/fragment_flight_detail">
        <argument
            android:name="flightId"
            android:defaultValue=""
            app:argType="string" />
        <action
            android:id="@+id/action_flightDetail_to_connectionRisk"
            app:destination="@id/connectionRiskDetailFragment" />
        <action
            android:id="@+id/action_flightDetail_to_timeline"
            app:destination="@id/flightTimelineFragment" />
        <action
            android:id="@+id/action_flightDetail_to_gateChangeAlert"
            app:destination="@id/gateChangeAlertFragment" />
        <action
            android:id="@+id/action_flightDetail_to_delayAlert"
            app:destination="@id/delayAlertFragment" />
    </fragment>

    <fragment
        android:id="@+id/connectionRiskDetailFragment"
        android:name="com.aerosense.app.ui.screens.flights.ConnectionRiskDetailFragment"
        android:label="Connection Risk"
        tools:layout="@layout/fragment_connection_risk_detail">
        <argument
            android:name="flightId"
            android:defaultValue=""
            app:argType="string" />
    </fragment>

    <fragment
        android:id="@+id/flightTimelineFragment"
        android:name="com.aerosense.app.ui.screens.flights.FlightTimelineFragment"
        android:label="Flight Timeline"
        tools:layout="@layout/fragment_flight_timeline">
        <argument
            android:name="flightId"
            android:defaultValue=""
            app:argType="string" />
    </fragment>

    <!-- Alert Screens (Full-screen modals) -->
    <fragment
        android:id="@+id/gateChangeAlertFragment"
        android:name="com.aerosense.app.ui.screens.flights.GateChangeAlertFragment"
        android:label="Gate Change Alert"
        tools:layout="@layout/fragment_gate_change_alert">
        <argument
            android:name="flightId"
            android:defaultValue=""
            app:argType="string" />
    </fragment>

    <fragment
        android:id="@+id/delayAlertFragment"
        android:name="com.aerosense.app.ui.screens.flights.DelayAlertFragment"
        android:label="Delay Alert"
        tools:layout="@layout/fragment_delay_alert">
        <argument
            android:name="flightId"
            android:defaultValue=""
            app:argType="string" />
    </fragment>

    <!-- Settings Sub-screens -->
    <fragment
        android:id="@+id/notificationSettingsFragment"
        android:name="com.aerosense.app.ui.screens.settings.NotificationSettingsFragment"
        android:label="Notification Settings"
        tools:layout="@layout/fragment_notification_settings" />

    <fragment
        android:id="@+id/accountSettingsFragment"
        android:name="com.aerosense.app.ui.screens.settings.AccountSettingsFragment"
        android:label="Account Settings"
        tools:layout="@layout/fragment_account_settings" />

    <!-- Bottom Sheets (Modals) -->
    <dialog
        android:id="@+id/addFlightBottomSheet"
        android:name="com.aerosense.app.ui.screens.flights.AddFlightBottomSheet"
        android:label="Add Flight"
        tools:layout="@layout/bottom_sheet_add_flight">
        <argument
            android:name="flightId"
            android:defaultValue=""
            app:argType="string"
            app:nullable="true" />
    </dialog>

</navigation>
